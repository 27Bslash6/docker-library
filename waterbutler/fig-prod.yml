# Data Containers

osfstoragedata:
    image: busybox:latest
    volumes:
        - /opt/osfstorage/pending:/data/osfstorage/pending
        - /opt/osfstorage/complete:/data/osfstorage/complete

rabbitmqdata:
    image: busybox:latest
    volumes:
        - /opt/rabbitmq:/var/lib/rabbitmq

redisdata:
    image: busybox:latest
    volumes:
        - /opt/redis:/data

# Service Containers

redis:
    image: redis:latest
    volumes_from:
        - redisdata

rabbitmq:
    image: rabbitmq:latest
    environment:
        - RABBITMQ_NODENAME=waterbutler
    links:
        - redis
    volumes_from:
        - rabbitmqdata

# Server Containers

tornado:
    build: ./tornado
    environment:
        - ENV=prod
    links:
        - rabbitmq
    ports:
        - "7777:7777"
    volumes:
        - ~/.cos/waterbutler-prod.json:/home/tornado/.cos/waterbutler-prod.json:ro
        - /data/osfstorage/pending
        - /data/osfstorage/complete
    volumes_from:
        - osfstoragedata
